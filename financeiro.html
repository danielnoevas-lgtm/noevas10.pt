<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Projeto Financeiro - Noevas10</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  textarea{width:100%;min-height:90px;border-radius:8px;padding:10px;margin-bottom:14px}
  label{display:block;margin:10px 0 6px;font-weight:600}
  .button{padding:12px 18px;border-radius:10px;background:#7a3cff;color:#fff;border:none;cursor:pointer;margin-top:10px;width:100%}
  .actions{display:flex;gap:12px;flex-direction:column}
</style>
</head>
<body>

<nav class="glass-nav">
  <div class="nav-container">
    <div class="logo">Noevas10</div>
    <ul class="nav-links">
      <li><a href="index.html">InÃ­cio</a></li>
      <li><a href="sobre.html">Sobre Mim</a></li>
      <li><a href="projetos.html">Projetos</a></li>
      <li><a href="contactos.html">Contactos</a></li>
      <li id="loginLink"><a href="login.html">Login</a></li>
      <li id="profileLink" style="display:none;"><a href="profile.html">Perfil</a></li>
      <li id="logoutLink" style="display:none;"><a href="#" onclick="logoutHandler();return false;">Sair</a></li>
    </ul>
    <div class="nav-cta"><a href="login.html">Entrar</a></div>
  </div>
</nav>

<main class="container" style="padding-top:120px">
  <h1>Projeto Financeiro</h1>
  <p>Responde com o mÃ¡ximo de detalhe possÃ­vel â€” isto permite criar um plano financeiro realista.</p>

  <form id="formProjetoFinanceiro" onsubmit="return false;">
    <div id="perguntasFinanceiro"></div>

    <div class="actions">
      <button type="button" class="button" onclick="enviarWhatsApp('financeiro')">ðŸ“© Enviar para WhatsApp</button>
      <button type="button" class="button" onclick="gerarPDF('financeiro')">ðŸ“„ Baixar PDF</button>
    </div>
  </form>
</main>

<script>
// perguntas (20) â€” profissional e detalhadas
const perguntasFinanceiras = [
  "1) Qual Ã© o teu rendimento mensal lÃ­quido atual (salÃ¡rio, freelance, outras fontes)?",
  "2) Lista as tuas despesas fixas mensais (renda, serviÃ§os, transportes, subscriÃ§Ãµes).",
  "3) Quais sÃ£o as tuas despesas variÃ¡veis mÃ©dias (alimentaÃ§Ã£o, lazer, compras)?",
  "4) Quanto consegues poupar atualmente por mÃªs, em mÃ©dia?",
  "5) Tens reservas de emergÃªncia? Se sim, quantos meses de despesas cobrem?",
  "6) Tens dÃ­vidas (cartÃµes, crÃ©dito, emprÃ©stimos)? Indica montantes e taxas aproximadas.",
  "7) Qual Ã© o teu objetivo financeiro prioritÃ¡rio para 12 meses (ex.: eliminar dÃ­vida, poupar Xâ‚¬)?",
  "8) Qual Ã© o teu objetivo financeiro a 3 anos (ex.: comprar carro, entrada casa, investimento)?",
  "9) Tens investimento atual (poupanÃ§a, aÃ§Ãµes, fundos, PPR)? Detalha se houver.",
  "10) Qual Ã© a tua tolerÃ¢ncia ao risco (baixa / mÃ©dia / alta) para investimentos?",
  "11) Quais sÃ£o os teus maiores bloqueios ou medos em relaÃ§Ã£o ao dinheiro?",
  "12) Tens um orÃ§amento mensal formal? Se sim, descreve o mÃ©todo que usas.",
  "13) Como organizas e controlas pagamentos recorrentes e faturas?",
  "14) Tens planos de reforma ou pensÃµes complementares? Indica detalhes.",
  "15) Estarias disponÃ­vel para reduzir despesas X meses para atingir um objetivo? Quais?",
  "16) Que hÃ¡bitos financeiros gostarias de melhorar (ex.: controlo, poupanÃ§a automÃ¡tica)?",
  "17) Que fontes de rendimento extra considerarias (freelance, venda, formaÃ§Ã£o)?",
  "18) Tens metas de curto prazo para compras (viagem, eletrÃ³nica, curso)? Indica valores.",
  "19) Precisas de ajuda para criar um plano de amortizaÃ§Ã£o de dÃ­vidas? Como preferes pagar (princ./juros)?",
  "20) Que mais informaÃ§Ã£o consideras importante sobre a tua situaÃ§Ã£o financeira?"
];

// render perguntas
const containerF = document.getElementById('perguntasFinanceiro');
let htmlF = '';
perguntasFinanceiras.forEach((q, idx)=>{
  htmlF += `<label>${q}</label><textarea id="fin_p${idx}" placeholder="Escreve aqui a tua resposta..."></textarea>`;
});
containerF.innerHTML = htmlF;

// utilitÃ¡rio: obter info de utilizador se logado
function obterInfoUtilizador(){
  const username = localStorage.getItem('site_session') || '';
  let profile = null;
  if(username){
    try { profile = JSON.parse(localStorage.getItem('profile_' + username)); }
    catch(e){ profile = null; }
  }
  return { username, profile };
}

// enviar para WhatsApp
function enviarWhatsApp(tipo){
  const info = obterInfoUtilizador();
  const nome = (info.profile && info.profile.nome) ? info.profile.nome : (info.username || 'Utilizador AnÃ³nimo');
  let texto = `Noevas10 â€” Projeto Financeiro\nUsuÃ¡rio: ${nome}\nData: ${new Date().toLocaleString()}\n\n`;
  perguntasFinanceiras.forEach((q, i)=>{
    const r = document.getElementById('fin_p'+i).value || '[sem resposta]';
    texto += `${i+1}. ${q}\nResposta: ${r}\n\n`;
  });
  const tel = "351931760077";
  const url = `https://wa.me/${tel}?text=${encodeURIComponent(texto)}`;
  window.open(url, '_blank');
}

// gerar PDF com jsPDF
async function gerarPDF(tipo){
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF({unit: 'pt', format: 'a4'});
  const info = obterInfoUtilizador();
  const nome = (info.profile && info.profile.nome) ? info.profile.nome : (info.username || 'Utilizador AnÃ³nimo');

  pdf.setFontSize(16);
  pdf.text("Projeto Financeiro â€” Noevas10", 40, 50);
  pdf.setFontSize(11);
  pdf.text(`UsuÃ¡rio: ${nome}`, 40, 70);
  pdf.text(`Data: ${new Date().toLocaleString()}`, 40, 86);

  let y = 110;
  pdf.setFontSize(10);
  perguntasFinanceiras.forEach((q, i)=>{
    const qText = `${i+1}. ${q}`;
    const rText = document.getElementById('fin_p'+i).value || '[sem resposta]';

    const splitQ = pdf.splitTextToSize(qText, 500);
    pdf.text(splitQ, 40, y);
    y += splitQ.length * 12;

    const splitR = pdf.splitTextToSize("Resposta: " + rText, 500);
    pdf.text(splitR, 55, y);
    y += splitR.length * 12 + 8;

    if(y > 750){
      pdf.addPage();
      y = 40;
    }
  });

  pdf.save('Projeto_Financeiro_Noevas10.pdf');
}

// mostrar/esconder links na navbar consoante sessÃ£o
(function(){
  const username = localStorage.getItem('site_session');
  if(username){
    const loginLink = document.getElementById('loginLink');
    const profileLink = document.getElementById('profileLink');
    const logoutLink = document.getElementById('logoutLink');
    if(loginLink) loginLink.style.display = 'none';
    if(profileLink) profileLink.style.display = 'inline-block';
    if(logoutLink) logoutLink.style.display = 'inline-block';
  }
})();
</script>

</body>
</html>
